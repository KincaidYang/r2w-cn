<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>使用 DNSPod 拉平 CNAME 记录（CDN 场景） | 归去如风</title><meta name="author" content="小泽"><meta name="copyright" content="小泽"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="由于 CNAME 跟任何记录都冲突的特性，在根域（@）下添加 CNAME 记录指向 CDN（或其他服务）会导致 mx（邮箱记录）、TXT（一些站长验证）、DS 等常用记录冲突等且多级 CNAME 会导致解析性能下降等问题，所以拉平是一个很不错的解决方案。但目前 DNSPod 并没有提供拉平的功能，所以需要自己写脚本调用 API 实现。（本文以腾讯云 CDN 为例，但是其他 CDN 服务商也可以使">
<meta property="og:type" content="article">
<meta property="og:title" content="使用 DNSPod 拉平 CNAME 记录（CDN 场景）">
<meta property="og:url" content="https://r2wind.cn/articles/20230108.html">
<meta property="og:site_name" content="归去如风">
<meta property="og:description" content="由于 CNAME 跟任何记录都冲突的特性，在根域（@）下添加 CNAME 记录指向 CDN（或其他服务）会导致 mx（邮箱记录）、TXT（一些站长验证）、DS 等常用记录冲突等且多级 CNAME 会导致解析性能下降等问题，所以拉平是一个很不错的解决方案。但目前 DNSPod 并没有提供拉平的功能，所以需要自己写脚本调用 API 实现。（本文以腾讯云 CDN 为例，但是其他 CDN 服务商也可以使">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://resources.r2wind.cn/img/202301/clouds-7689828_1920.jpg">
<meta property="article:published_time" content="2023-01-08T04:29:50.000Z">
<meta property="article:modified_time" content="2023-05-10T12:29:50.000Z">
<meta property="article:author" content="小泽">
<meta property="article:tag" content="DNSPod">
<meta property="article:tag" content="作品集">
<meta property="article:tag" content="域名">
<meta property="article:tag" content="腾讯云">
<meta property="article:tag" content="解析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://resources.r2wind.cn/img/202301/clouds-7689828_1920.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "使用 DNSPod 拉平 CNAME 记录（CDN 场景）",
  "url": "https://r2wind.cn/articles/20230108.html",
  "image": "https://resources.r2wind.cn/img/202301/clouds-7689828_1920.jpg",
  "datePublished": "2023-01-08T04:29:50.000Z",
  "dateModified": "2023-05-10T12:29:50.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "小泽",
      "url": "https://r2wind.cn"
    }
  ]
}</script><link rel="shortcut icon" href="https://resources.r2wind.cn/img/logo.ico"><link rel="canonical" href="https://r2wind.cn/articles/20230108.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><meta/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://mirrors.r2wind.cn/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MG9VW91X52"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-MG9VW91X52')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-MG9VW91X52', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://mirrors.r2wind.cn/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '使用 DNSPod 拉平 CNAME 记录（CDN 场景）',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://fonts.r2wind.cn/fonts.css"><script src="https://tam.cdn-go.cn/aegis-sdk/latest/aegis.min.js"></script><script src="https://resources.r2wind.cn/js/rum.js"></script><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="归去如风" type="application/atom+xml">
</head><body><div class="bg-animation" id="web_bg" style="background-image: url(https://resources.r2wind.cn/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://resources.r2wind.cn/img/avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-thumbs-up"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> 语言</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://yjz.hk"><span> 繁體中文</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://r2wind.com"><span> English</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">归去如风</span></a><a class="nav-page-title" href="/"><span class="site-name">使用 DNSPod 拉平 CNAME 记录（CDN 场景）</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-thumbs-up"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> 语言</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://yjz.hk"><span> 繁體中文</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://r2wind.com"><span> English</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">使用 DNSPod 拉平 CNAME 记录（CDN 场景）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-01-08T04:29:50.000Z" title="发表于 2023-01-08 12:29:50">2023-01-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-10T12:29:50.000Z" title="更新于 2023-05-10 20:29:50">2023-05-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/">教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><blockquote>
<p>由于 CNAME 跟任何记录都冲突的特性，在根域（@）下添加 CNAME 记录指向 CDN（或其他服务）会导致 mx（邮箱记录）、TXT（一些站长验证）、DS 等常用记录冲突等且多级 CNAME 会导致解析性能下降等问题，所以拉平是一个很不错的解决方案。但目前 DNSPod 并没有提供拉平的功能，所以需要自己写脚本调用 API 实现。（本文以腾讯云 CDN 为例，但是其他 CDN 服务商也可以使用，替换脚本里面的 CNAME 域名即可。）<br>PS：自2019年1月接触互联网行业以来一直在做运营相关的工作，本身也不是学计算机相关专业的，代码写的可能不是很好，欢迎大佬们指正。</p>
</blockquote>
<h2 id="操作场景"><a href="#操作场景" class="headerlink" title="操作场景"></a>操作场景</h2><p>本文将指导您如何使用 DNSPod 的 API 实现拉平 CNAME 记录，以解决相关记录冲突的问题。（以腾讯云 CDN 为例）</p>
<h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><ul>
<li>域名解析托管在腾讯云 DNSPod。</li>
<li>域名已绑定企业版或更高版本套餐。</li>
</ul>
<h2 id="方法说明"><a href="#方法说明" class="headerlink" title="方法说明"></a>方法说明</h2><h3 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h3><p><img src="https://resources.r2wind.cn/img/202301/DNSPodFlattening.png" alt="流程图"><br>实现的方法大体如上图所示，获取 CDN 在31个省份三大运营商的调度结果，然后将调度结果更新到 DNSPod 上。</p>
<h3 id="相关说明"><a href="#相关说明" class="headerlink" title="相关说明"></a>相关说明</h3><ul>
<li>因本人海外访问全部由 Cloudflare 提供服务，且由于服务 IP 基本固定，故本脚本中未考虑海外使用 CDN 的情况，如果 CDN 有海外节点，可以在脚本中自行添加海外 CDN 调度部分。</li>
<li>需要企业版或更高版本套餐的原因是因为从企业版开始才支持分省分运营商解析调度。（或许有时间写个华为云 DNS 的）</li>
<li>考虑 CDN 存在多级 CNAME 的情况，本脚本从 DoH 获取的调度结果第二个 “data” 才开始取值，由于 CDN 每次返回的 IP 数量不一，仅取两个 IP，能满足目前大部分 CDN 的情况，当然不排除有些 CDN 存在多级 CNAME 的情况，这种情况下需要自行修改脚本。</li>
<li>考虑到并非所有人都开启了 IPv6，故本脚本分为 IPv4 和 IPv6 两个版本，您可根据自身情况选择使用。</li>
</ul>
<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><h4 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h4><p>GitHub 地址：<a target="_blank" rel="noopener" href="https://github.com/KincaidYang/CNAMEFlattening">https://github.com/KincaidYang/CNAMEFlattening</a></p>
<h4 id="Flame-版本"><a href="#Flame-版本" class="headerlink" title="Flame 版本"></a>Flame 版本</h4><p>该版本适用于腾讯云 CDN、华为云 CDN<br>直接下载（IPv4 脚本）：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Flame/DNSPod-Flame-IPv4.py">https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Flame/DNSPod-Flame-IPv4.py</a><br>直接下载（IPv6 脚本）：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Flame/DNSPod-Flame-IPv6.py">https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Flame/DNSPod-Flame-IPv6.py</a></p>
<h4 id="Frost-版本"><a href="#Frost-版本" class="headerlink" title="Frost 版本"></a>Frost 版本</h4><p>该版本适用于腾讯云 EdgeOne、阿里云 CDN、天翼云 CDN<br>直接下载（IPv4 脚本）：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Frost/DNSPod-Frost-IPv4.py">https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Frost/DNSPod-Frost-IPv4.py</a><br>直接下载（IPv6 脚本）：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Frost/DNSPod-Frost-IPv6.py">https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Frost/DNSPod-Frost-IPv6.py</a></p>
<h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><h3 id="获取脚本"><a href="#获取脚本" class="headerlink" title="获取脚本"></a>获取脚本</h3><p>您可直接下载脚本，或者使用 git clone 命令下载本脚本。<br>直接下载：</p>
<h4 id="Flame-版本-1"><a href="#Flame-版本-1" class="headerlink" title="Flame 版本"></a>Flame 版本</h4><p>该版本适用于腾讯云 CDN、华为云 CDN:<br>IPv4 脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Flame/DNSPod-Flame-IPv4.py</span><br></pre></td></tr></table></figure>
<p>IPv6 脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Flame/DNSPod-Flame-IPv6.py</span><br></pre></td></tr></table></figure>
<h4 id="Frost-版本-1"><a href="#Frost-版本-1" class="headerlink" title="Frost 版本"></a>Frost 版本</h4><p>该版本适用于腾讯云 EdgeOne、阿里云 CDN、天翼云 CDN:<br>IPv4 脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Frost/DNSPod-Frost-IPv4.py</span><br></pre></td></tr></table></figure>
<p>IPv6 脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.r2wind.cn/script/CNAMEFlattening/DNSPod/Frost/DNSPod-Frost-IPv6.py</span><br></pre></td></tr></table></figure>
<h4 id="使用-git-clone-命令下载脚本"><a href="#使用-git-clone-命令下载脚本" class="headerlink" title="使用 git clone 命令下载脚本"></a>使用 git clone 命令下载脚本</h4><p>使用 git clone 命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/KincaidYang/CNAMEFlattening.git</span><br></pre></td></tr></table></figure>
<h3 id="修改变量配置"><a href="#修改变量配置" class="headerlink" title="修改变量配置"></a>修改变量配置</h3><p>打开脚本，修改以下变量：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置参数</span></span><br><span class="line"><span class="comment"># domanin替换为自己的域名，如&#x27;r2wind.cn&#x27;</span></span><br><span class="line">domain=<span class="string">&#x27;xxx.cn&#x27;</span></span><br><span class="line"><span class="comment"># sub_domain替换为自己的子域名，如&#x27;@&#x27;或&#x27;www&#x27;</span></span><br><span class="line">subdomain=<span class="string">&#x27;xxx&#x27;</span></span><br><span class="line"><span class="comment"># CDNCNAME请替换为CDN提供的CNAME地址，如&#x27;r2wind.cn.cdn.dnsv1.com&#x27;</span></span><br><span class="line">CDNCNAME=<span class="string">&#x27;xxx.xxx.xxx.cn&#x27;</span></span><br><span class="line"><span class="comment"># SecretId请替换为自己的腾讯云SecretId，可前往https://console.cloud.tencent.com/cam/capi获取</span></span><br><span class="line">SecretId=<span class="string">&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line"><span class="comment"># SecretKey请替换为自己的腾讯云SecretKey，可前往https://console.cloud.tencent.com/cam/capi获取</span></span><br><span class="line">SecretKey=<span class="string">&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line"><span class="comment"># URL为 DNSPod DOH接口地址，用以获取CDN实时解析情况，可自行替换为其他厂商的DoH接口</span></span><br><span class="line">DoH=<span class="string">&#x27;https://1.12.12.12/resolve&#x27;</span></span><br><span class="line"><span class="comment"># 记录类型(&quot;A&quot;为IPv4，&quot;AAAA&quot;为IPv6)</span></span><br><span class="line">record_type=<span class="string">&#x27;A&#x27;</span></span><br></pre></td></tr></table></figure>
<p>本站配置示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置参数</span></span><br><span class="line"><span class="comment"># domanin替换为自己的域名</span></span><br><span class="line">domain=<span class="string">&#x27;r2wind.cn&#x27;</span></span><br><span class="line"><span class="comment"># sub_domain替换为自己的子域名</span></span><br><span class="line">subdomain=<span class="string">&#x27;@&#x27;</span></span><br><span class="line"><span class="comment"># CDNCNAME请替换为CDN提供的CNAME地址</span></span><br><span class="line">CDNCNAME=<span class="string">&#x27;r2wind.cn.cdn.qcloudcdn.cn&#x27;</span></span><br><span class="line"><span class="comment"># SecretId请替换为自己的腾讯云SecretId</span></span><br><span class="line">SecretId=<span class="string">&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line"><span class="comment"># SecretKey请替换为自己的腾讯云SecretKey</span></span><br><span class="line">SecretKey=<span class="string">&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line"><span class="comment"># URL为 DNSPod DOH接口地址，用以获取CDN实时解析情况，可自行替换</span></span><br><span class="line">DoH=<span class="string">&#x27;https://1.12.12.12/resolve&#x27;</span></span><br><span class="line"><span class="comment"># 记录类型(&quot;A&quot;为IPv4，&quot;AAAA&quot;为IPv6)</span></span><br><span class="line">record_type=<span class="string">&#x27;A&#x27;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：<br>若觉得下方用于 ECS 协议的 IP 子网存在问题，可自行修改。</p>
</blockquote>
<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>脚本使用 Python3 运行，故您需要安装 Python3 环境。（一般镜像都会预装 Python3）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS/RHEL</span></span><br><span class="line">yum install python3</span><br><span class="line"><span class="comment"># Debian/Ubuntu</span></span><br><span class="line">apt install python3</span><br></pre></td></tr></table></figure>
<p>本脚本使用了 requests 库和腾讯云 SDK，故您还需要安装 requests 库和 SDK。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># requests 库</span></span><br><span class="line">pip3 install requests</span><br><span class="line"><span class="comment"># 腾讯云 SDK</span></span><br><span class="line">pip3 install tencentcloud-sdk-python</span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：<br>某些系统下可能需要将 pip3 替换为 pip。</p>
</blockquote>
<h3 id="导入记录"><a href="#导入记录" class="headerlink" title="导入记录"></a>导入记录</h3><p>使用前请您前往<a target="_blank" rel="noopener" href="https://console.dnspod.cn/dns/list">DNSPod 控制台</a>添加相应记录，否则本脚本将无法正常运行，或参照下述方式导入记录。</p>
<h4 id="下载记录模板"><a href="#下载记录模板" class="headerlink" title="下载记录模板"></a>下载记录模板</h4><h5 id="Flame-版本-2"><a href="#Flame-版本-2" class="headerlink" title="Flame 版本"></a>Flame 版本</h5><p>适用于腾讯云 CDN、华为云 CDN<br>IPv4 模板：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/template/DNSPod-IPv4-Flame.xls">https://dl.r2wind.cn/template/DNSPod-IPv4-Flame.xls</a><br>IPv6 模板：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/template/DNSPod-IPv6-Flame.xls">https://dl.r2wind.cn/template/DNSPod-IPv6-Flame.xls</a></p>
<h5 id="Frost-版本-2"><a href="#Frost-版本-2" class="headerlink" title="Frost 版本"></a>Frost 版本</h5><p>适用于腾讯云 EdgeOne、阿里云 CDN、天翼云 CDN<br>IPv4 模板：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/template/DNSPod-IPv4-Frost.xls">https://dl.r2wind.cn/template/DNSPod-IPv4-Frost.xls</a><br>IPv6 模板：<a target="_blank" rel="noopener" href="https://dl.r2wind.cn/template/DNSPod-IPv6-Frost.xls">https://dl.r2wind.cn/template/DNSPod-IPv6-Frost.xls</a></p>
<blockquote>
<p>说明：<br>请根据版本选择相应模板。<br>导入前请自行修改模板中的主机记录。（若有需要）<br>导入前请自行修改模板中的记录值为当前 CDN 节点 IP，否则会影响域名正常访问。（节点 IP 可以通过nslookup查询CDN CNAME地址获取）<br>若需要导入的记录已在控制台添加过，请删除原有记录后再导入。</p>
</blockquote>
<h4 id="导入记录-1"><a href="#导入记录-1" class="headerlink" title="导入记录"></a>导入记录</h4><ol>
<li>登录 <a target="_blank" rel="noopener" href="https://console.dnspod.cn/dns/batch/import-record">DNSPod 控制台</a>，进入<strong>批量操作-导入记录</strong>页面。</li>
<li>输入需要导入的域名，上传已经修改好的模板，点击<strong>导入</strong>。</li>
<li>等待导入完成，请注意查看导入结果，若有导入失败的记录，查看原因修正后手动添加记录，不要重复导入。</li>
</ol>
<h3 id="调试脚本"><a href="#调试脚本" class="headerlink" title="调试脚本"></a>调试脚本</h3><p>请先在本地使用编辑器（如VScode）调试脚本，若调试成功则可继续部署。<br>若脚本正常运行，您将看到类似如下输出：<br>{“RecordId”: 1300xxxxxx, “RequestId”: “b690601d-b97f-46fa-a5fb-xxxxxxxxxx”}<br>或<br>[TencentCloudSDKException] code:InvalidParameter.DomainRecordExist message:记录已经存在，无需再次添加</p>
<h3 id="部署运行"><a href="#部署运行" class="headerlink" title="部署运行"></a>部署运行</h3><p>脚本使用 cron 定时运行，故您需要安装 cron。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS/RHEL</span></span><br><span class="line">yum install cronie</span><br><span class="line"><span class="comment"># Debian/Ubuntu</span></span><br><span class="line">apt install cron</span><br></pre></td></tr></table></figure>
<p>安装完成后，您需要编辑 crontab 文件，添加定时任务。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>
<p>在 crontab 文件中添加如下内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/5 * * * * python3 /root/DNSPodCDNv4.py</span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：<br>本配置每 5 分钟运行一次，您可以根据需要自行修改。<br>请将 &#x2F;root&#x2F;DNSPodCDNv4.py 替换为您的脚本路径。<br>若您使用的是 IPv6 脚本，请将上述内容替换为 *&#x2F;5 * * * * python3 &#x2F;root&#x2F;DNSPodCDNv6.py</p>
</blockquote>
<h3 id="验证效果"><a href="#验证效果" class="headerlink" title="验证效果"></a>验证效果</h3><p>您可以在 <a target="_blank" rel="noopener" href="https://console.dnspod.cn/dns/list">DNSPod 控制台</a>查看对应域名的相关记录，若记录值已经更新为 CDN 节点 IP，则说明脚本运行成功。</p>
<h3 id="D-监控"><a href="#D-监控" class="headerlink" title="D 监控"></a>D 监控</h3><p>可开启 D 监控配合使用，注意调整监控频率，监控频率应小于更新频率。<br>注：D 监控仅支持 IPv4。</p>
<h2 id="问题反馈"><a href="#问题反馈" class="headerlink" title="问题反馈"></a>问题反馈</h2><p>若您在使用过程中遇到任何问题，欢迎您提交 <a target="_blank" rel="noopener" href="https://github.com/KincaidYang/CNAMEFlattening/issues">Issue</a>。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://r2wind.cn">小泽</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://r2wind.cn/articles/20230108.html">https://r2wind.cn/articles/20230108.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://r2wind.cn" target="_blank">归去如风</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DNSPod/">DNSPod</a><a class="post-meta__tags" href="/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/">腾讯云</a><a class="post-meta__tags" href="/tags/%E5%9F%9F%E5%90%8D/">域名</a><a class="post-meta__tags" href="/tags/%E8%A7%A3%E6%9E%90/">解析</a><a class="post-meta__tags" href="/tags/%E4%BD%9C%E5%93%81%E9%9B%86/">作品集</a></div><div class="post-share"><div class="social-share" data-image="https://resources.r2wind.cn/img/202301/clouds-7689828_1920.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://mirrors.r2wind.cn/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://mirrors.r2wind.cn/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/articles/20230109.html" title="使用华为云 DNS 拉平 CNAME 记录（CDN 场景）"><img class="cover" src="https://resources.r2wind.cn/img/202301/ship-7679100_1920.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">使用华为云 DNS 拉平 CNAME 记录（CDN 场景）</div></div><div class="info-2"><div class="info-item-1"> 接上一篇文章使用 DNSPod 拉平 CNAME 记录（CDN 场景）这篇文章将介绍如何使用华为云 DNS 拉平 CNAME 记录（CDN 场景）。  操作场景本文将指导您如何使用华为云 DNS 的 API 实现拉平 CNAME 记录，以解决相关记录冲突的问题。 方法说明不再重复说明了，如有兴趣请看使用 DNSPod 拉平 CNAME 记录（CDN 场景） 前提条件 域名解析托管在华为云 DNS  项目地址https://github.com/KincaidYang/CNAMEFlattening 操作步骤获取脚本Flame 版本该版本适用于腾讯云 CDN、华为云 CDNIPv4 脚本： 1wget https://dl.r2wind.cn/script/CNAMEFlattening/HuaweiCloud/Flame/Huaweicloud-Flame-IPv4.py IPv6 脚本： 1wget https://dl.r2wind.cn/script/CNAMEFlattening/HuaweiCloud/Flame/Huaweicloud-Flame-IPv6.py F...</div></div></div></a><a class="pagination-related" href="/articles/20221111.html" title="本站现已支持 HTTPS 记录（Type65)"><img class="cover" src="https://resources.r2wind.cn/img/202211/hd-wallpaper-7496901_1920.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">本站现已支持 HTTPS 记录（Type65)</div></div><div class="info-2"><div class="info-item-1"> 基于 DNSPod 提供的解析能力，本站现已支持 HTTPS 记录 (HTTPS record) 即 Type65 记录，截至发文时，该记录相关规范仍在处理中，尚未最终确定，但已有部分厂商开始使用，如 CloudFlare、Apple 等。在 ios14 以后的版本上，系统会优先查询 HTTPS 记录，因此合理的配置 HTTPS 记录可以有效的提升 ios 用户的访问体验。其他浏览器如 Chrome 对该记录的支持目前还处于试验阶段，可通过 chrome:&#x2F;&#x2F;flags&#x2F; 配置开启。  记录相关介绍HTTPS 记录是一种新的 DNS 记录类型，关于其详细介绍请参阅：draft-ietf-dnsop-svcb-https-11。 配置方法由于该记录仍在草案处理中，本文不再详细介绍配置方法，具体可参见：设置 HTTPS 记录。 相关测试1234567891011121314151617; &lt;&lt;&gt;&gt; DiG 9.16.30 &lt;&lt;&gt;&gt; r2wind.cn https;; global options: +cm...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/articles/20220215.html" title="群晖设置DDNS并实现腾讯云免费SSL证书的自动申请与部署"><img class="cover" src="https://resources.r2wind.cn/img/202202/tree-6792528_1280.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-15</div><div class="info-item-2">群晖设置DDNS并实现腾讯云免费SSL证书的自动申请与部署</div></div><div class="info-2"><div class="info-item-1"> 本教程仅适用于DSM7.0及以上版本且域名解析托管在腾讯云DNSPod的用户,DSM6.X用户请参考：在DNSPod解析的域名如何设置DDNS(动态域名解析)和群晖部署SSL证书实现HTTPS安全访问进行DDNS设置以及SSL证书部署。  2024年2月28日更新：由于腾讯云 SSL 的自动 DNS 验证需要完成 CAM 授权，请需要同步部署证书的用户在开启 DDNS 前前往腾讯云 SSL 证书控制台手动为你的域名申请免费证书，并选择自动 DNS 验证方式，并在弹出的窗口中完成 CAM 授权。否则将无法完成自动申请证书。PS：仅需要完成授权即可，授权后可以关闭SSL证书控制台页面，不需要真的申请一张证书。   获取腾讯云API密钥1、打开并登录控制台-API密钥  注意这里一定要选择”腾讯云API密钥”而非”DNSPod Token”。  2、点击新建密钥，这里可能会进行安全验证，按照提示验证即可。3、记录密钥SecretId及SecretKey 添加解析记录1、打开并登录解析控制台2、找到对应的域名点击管理，这里以oed.im为例3、设置解析记录点击添加记录填写对应信息后点击...</div></div></div></a><a class="pagination-related" href="/articles/20220522.html" title="DNS+IGTM实现访问流量智能调度"><img class="cover" src="https://resources.r2wind.cn/img/202205/seascape-4636549_1920.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-22</div><div class="info-item-2">DNS+IGTM实现访问流量智能调度</div></div><div class="info-2"><div class="info-item-1">操作场景智能全局流量管理（Intelligence Global Traffic Manager），简称IGTM，它可以帮助用户实现应用（例如：网页应用、直播、点播）的网络健康检查，并根据检测结果实现故障隔离和流量调度切换。也可根据用户地理位置或延迟实现流量的智能调度，从而实现各区域用户的就近接入。本文以通过DNS（IGTM）实现边缘节点智能调度为例进行演示。 适用场景需根据用户地理位置将流量调度到适合的边缘节点，并实现故障节点的自动剔除&amp;将流量分摊至不同的负载均衡节点，提升用户的访问体验的客户。 例如：CDN、直播、点播、手机（应用分发&#x2F;更新、系统升级等）、游戏（资源更新&#x2F;分发）、大型网站等。 场景需求描述： 说明：下述描述、图片仅为本案例中涉及到的相关场景、需求、节点分布，仅供参考，实际使用中请根据需要自行调整，或咨询您的客户经理获取专属方案。  场景描述 客户为提升全球用户访问体验，通过在全球各地域部署多台边缘节点的方式来提升用户访问速度和稳定性。  需求描述 根据客户地理位置或延迟返回不同地域的节点IP，并自动剔除故障边缘节点； 当自建CDN节...</div></div></div></a><a class="pagination-related" href="/articles/20221020.html" title="如何正确变更 DNSPod 解析套餐（降级场景）"><img class="cover" src="https://resources.r2wind.cn/img/202210/bridge-7504605_1920.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-20</div><div class="info-item-2">如何正确变更 DNSPod 解析套餐（降级场景）</div></div><div class="info-2"><div class="info-item-1">操作场景本文将指导您如何完成 DNSPod 解析套餐的变更，适用于降级场景（将套餐由高版本改至低版本，如企业版更换为专业版）。 前提条件 拥有需变更套餐域名的管理权限。 已购买其他版本套餐，若降级至免费版本，请忽略。  操作步骤将域名 DNS 服务器更改为免费版本 说明：由于降级 DNS 套餐版本需要解绑当前套餐，解绑套餐后若域名 DNS 服务器仍为原套餐版本的 DNS 服务器地址将导致域名无法解析；且受各地运营商递归 DNS 缓存影响，即使在变更套餐后及时修改域名 DNS 服务器地址为当前版本套餐地址，也可能导致在 72 小时内出现解析异常等影响业务的情况。所以在变更套餐前请您将域名 DNS 服务器更换为免费版本，以确保降级套餐不会影响正常解析。  获取免费版本 DNS 服务器地址 登录腾讯云 DNSPod控制台。 单击 DNS解析，在我的域名页面点击需要变更套餐的域名。 进入后单击域名设置并点击查看免费版的 DNS 服务器。 记录免费版本 DNS 服务器并前往域名注册商将 DNS 服务器变更为免费版本。  更改域名 DNS 服务器域名在腾讯云若您为腾讯云平台注册域名，请登录腾...</div></div></div></a><a class="pagination-related" href="/articles/20220624.html" title="爱名网(22.cn)、HKDNR、GoogleDomains、AWSRoute53注册域名开启DNSSEC（解析托管在DNSPod）"><img class="cover" src="https://resources.r2wind.cn/img/202206/hd-wallpaper-3625405_1920.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-24</div><div class="info-item-2">爱名网(22.cn)、HKDNR、GoogleDomains、AWSRoute53注册域名开启DNSSEC（解析托管在DNSPod）</div></div><div class="info-2"><div class="info-item-1"> DNSSEC对权威dns提供给递归DNS的解析数据来源进⾏认证，可有效保护权威DNS和Local DNS之间数据不被攻击篡改，确保解析结果的真实与可靠性。本文以域名解析托管在DNSPod为例，其他平台可参考本文或咨询对应平台客服。  前提条件 目前DNSPod DNS仅支持付费套餐（任意版本）使用DNSSEC，使用DNSSEC前请购买合适版本的解析套餐。  操作步骤开启并获取DNSSEC配置信息登录DNSPod解析管理控制台 进入详情域名页面单击需要设置DNSSEC的域名进入解析详情页面 开启DNSSEC在”域名设置”中找到DNSSEC并点击”立即启用” 获取配置信息在弹出的窗口中即可看到相关的配置信息（如下图），请根据提示的信息前往对应的域名注册商进行配置，配置完成后后点击”确定”即可，下文将介绍爱名网(22.cn)、HKDNR、GoogleDomains、AWSRoute53注册域名配置方式  PS:在域名注册商配置完成后一定要回来点确定！！！  配置DNSSEC（DS）记录爱名网（22.cn）配置DS记录登录会员中心登录爱名网会员中心 进入域名详情在”我的域名”中单击需要...</div></div></div></a><a class="pagination-related" href="/articles/20210809.html" title="DNS解析出现问题怎么办？"><img class="cover" src="https://resources.r2wind.cn/img/mountain-6320288_1280.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-10</div><div class="info-item-2">DNS解析出现问题怎么办？</div></div><div class="info-2"><div class="info-item-1"> 我们在使用DNS解析的过程中难免会遇到各种问题，在这里以腾讯云DNSPOD为例，写一下在遇到解析问题时如何排查，文章较长，可点击右下方目录直接跳转到你想看的地方。  确定是否为解析问题 一些新手会认为网站不能访问就是解析的锅，但其实并不一定是，所以我们首先要确定一下是否为解析问题。我们可以使用nslookup或dig等工具去判断解析是否正常，由于Windows系统基本只带了nslookup工具，所以接下来我们以nslookup为例。注：1、判断的前提条件是你已经在解析控制台添加了相应的记录，重要的事情说三遍：请确保您已经在控制台添加相应的记录！请确保您已经在控制台添加相应的记录！请确保您已经在控制台添加相应的记录！2、nslookup查询的域名可以是主域名（example.com）也可以是子域名（www.example.com），在查询时请以实际设置的主机记录为准。  判断A记录、AAAA记录、CNAME记录是否正常1nslookup 域名 例： 1nslookup r2wind.com 如图所示，可以正常查询到A记录或AAAA记录，解析正常，若异常，请参照解析问题排除。  若...</div></div></div></a><a class="pagination-related" href="/articles/20230806.html" title="DNS+HTTPDNS 实现 CNAME 展平 (CNAME Flattening)"><img class="cover" src="https://resources.r2wind.cn/img/202308/squirrel-8154277_1920.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-06</div><div class="info-item-2">DNS+HTTPDNS 实现 CNAME 展平 (CNAME Flattening)</div></div><div class="info-2"><div class="info-item-1"> 本文将介绍如何使用 DNS (DNSPod) +HTTPDNS 实现 CNAME 展平 (CNAME Flattening)。一直以来，由于 CNAME 记录和任何记录冲突的独有特性，导致一旦在根域使用 CNAME 解析，将导致其他记录无法正常使用，影响 DS (DNSSEC)、MX (邮箱服务)、TXT (SPF、DKIM、DMARC、站长平台验证) 等记录的使用，进而影响依赖这些记录的相关服务（如括号内所示），而 CNAME 展平 (CNAME Flattening) 是解决这个问题的一种方法，但由于 DNSPod 本身不支持 CNAME 展平 (CNAME Flattening)，所以本文将介绍如何使用 DNS+HTTPDNS 通过 API 调用的方式实现 CNAME 展平 (CNAME Flattening)。   为确保能精准稳定的获取到 CDN 等厂商提供的 CNAME 记录所对应的解析 IP（调度结果），脚本需要使用 HTTPDNS 服务，HTTPDNS 服务可能产生对应的请求次数费用，具体费用请参考 HTTPDNS 计费说明。  前提条件 域名解析托管在 DNS...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://resources.r2wind.cn/img/avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">小泽</div><div class="author-info-description">一个自由自在的互联网民工</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/KincaidYang" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:yjz@r2wind.org" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Welcome!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%9C%BA%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">操作场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">前提条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E8%AF%B4%E6%98%8E"><span class="toc-number">3.</span> <span class="toc-text">方法说明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-number">3.1.</span> <span class="toc-text">流程图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E8%AF%B4%E6%98%8E"><span class="toc-number">3.2.</span> <span class="toc-text">相关说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC"><span class="toc-number">3.3.</span> <span class="toc-text">脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80"><span class="toc-number">3.3.1.</span> <span class="toc-text">项目地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flame-%E7%89%88%E6%9C%AC"><span class="toc-number">3.3.2.</span> <span class="toc-text">Flame 版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Frost-%E7%89%88%E6%9C%AC"><span class="toc-number">3.3.3.</span> <span class="toc-text">Frost 版本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">4.</span> <span class="toc-text">操作步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%84%9A%E6%9C%AC"><span class="toc-number">4.1.</span> <span class="toc-text">获取脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Flame-%E7%89%88%E6%9C%AC-1"><span class="toc-number">4.1.1.</span> <span class="toc-text">Flame 版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Frost-%E7%89%88%E6%9C%AC-1"><span class="toc-number">4.1.2.</span> <span class="toc-text">Frost 版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-git-clone-%E5%91%BD%E4%BB%A4%E4%B8%8B%E8%BD%BD%E8%84%9A%E6%9C%AC"><span class="toc-number">4.1.3.</span> <span class="toc-text">使用 git clone 命令下载脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE"><span class="toc-number">4.2.</span> <span class="toc-text">修改变量配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="toc-number">4.3.</span> <span class="toc-text">安装依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E8%AE%B0%E5%BD%95"><span class="toc-number">4.4.</span> <span class="toc-text">导入记录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E8%AE%B0%E5%BD%95%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.4.1.</span> <span class="toc-text">下载记录模板</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Flame-%E7%89%88%E6%9C%AC-2"><span class="toc-number">4.4.1.1.</span> <span class="toc-text">Flame 版本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Frost-%E7%89%88%E6%9C%AC-2"><span class="toc-number">4.4.1.2.</span> <span class="toc-text">Frost 版本</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E8%AE%B0%E5%BD%95-1"><span class="toc-number">4.4.2.</span> <span class="toc-text">导入记录</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%AC"><span class="toc-number">4.5.</span> <span class="toc-text">调试脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E8%BF%90%E8%A1%8C"><span class="toc-number">4.6.</span> <span class="toc-text">部署运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E6%95%88%E6%9E%9C"><span class="toc-number">4.7.</span> <span class="toc-text">验证效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#D-%E7%9B%91%E6%8E%A7"><span class="toc-number">4.8.</span> <span class="toc-text">D 监控</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%8F%8D%E9%A6%88"><span class="toc-number">5.</span> <span class="toc-text">问题反馈</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/articles/20251220.html" title="ARI是什么？ACME自动续签证书为什么不能再“自己算时间”了"><img src="https://resources.r2wind.cn/img/202512/field-9295186_1920.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ARI是什么？ACME自动续签证书为什么不能再“自己算时间”了"/></a><div class="content"><a class="title" href="/articles/20251220.html" title="ARI是什么？ACME自动续签证书为什么不能再“自己算时间”了">ARI是什么？ACME自动续签证书为什么不能再“自己算时间”了</a><time datetime="2025-12-20T06:08:02.000Z" title="发表于 2025-12-20 14:08:02">2025-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/articles/20251214.html" title="使用 OpenSSL 编译 Nginx 并开启 Quic 或 HTTP/3"><img src="https://resources.r2wind.cn/img/202512/mountain-lake-10009812_1920.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 OpenSSL 编译 Nginx 并开启 Quic 或 HTTP/3"/></a><div class="content"><a class="title" href="/articles/20251214.html" title="使用 OpenSSL 编译 Nginx 并开启 Quic 或 HTTP/3">使用 OpenSSL 编译 Nginx 并开启 Quic 或 HTTP/3</a><time datetime="2025-12-14T12:30:30.000Z" title="发表于 2025-12-14 20:30:30">2025-12-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/articles/20250722.html" title="CodeBuddy - 全球首款产设研一体的 AI 全栈工程师体验如何？"><img src="https://resources.r2wind.cn/img/202507/website.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CodeBuddy - 全球首款产设研一体的 AI 全栈工程师体验如何？"/></a><div class="content"><a class="title" href="/articles/20250722.html" title="CodeBuddy - 全球首款产设研一体的 AI 全栈工程师体验如何？">CodeBuddy - 全球首款产设研一体的 AI 全栈工程师体验如何？</a><time datetime="2025-07-22T00:00:00.000Z" title="发表于 2025-07-22 08:00:00">2025-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/articles/20250203.html" title="使用宝塔面板部署一个属于自己的 DeepSeek"><img src="https://resources.r2wind.cn/img/202502/robin-9376529_1920.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用宝塔面板部署一个属于自己的 DeepSeek"/></a><div class="content"><a class="title" href="/articles/20250203.html" title="使用宝塔面板部署一个属于自己的 DeepSeek">使用宝塔面板部署一个属于自己的 DeepSeek</a><time datetime="2025-02-03T04:35:22.000Z" title="发表于 2025-02-03 12:35:22">2025-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/articles/20241226.html" title="在 istoreos 上部署宝塔面板"><img src="https://resources.r2wind.cn/img/202412/winter-4680354_1920.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在 istoreos 上部署宝塔面板"/></a><div class="content"><a class="title" href="/articles/20241226.html" title="在 istoreos 上部署宝塔面板">在 istoreos 上部署宝塔面板</a><time datetime="2024-12-26T02:58:56.000Z" title="发表于 2024-12-26 10:58:56">2024-12-26</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://resources.r2wind.cn/background.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2017 - 2025 By 小泽</span><span class="framework-info"><span>Power By </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme By </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a><span class="footer-separator">|</span><span>CoverImage By </span><a target="_blank" rel="noopener" href="https://pixabay.com/">Pixabay</a></span></div><div class="footer_custom_text"><a href="https://beian.mps.gov.cn/#/query/webSearch?code=21132402000032" rel="noreferrer" target="_blank"><img src="https://resources.r2wind.cn/img/gaba.png" alt="公安备案" style="width:20px; height:20px; vertical-align:sub;">辽公网安备21132402000032</a> <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><span>辽ICP备18005232号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://mirrors.r2wind.cn/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax data-prefix="busuanzi_value" src="https://vortex.r2wind.cn/js"></script></div></body></html>